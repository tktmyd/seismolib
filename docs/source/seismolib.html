<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seismolib package &mdash; seismolib  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            seismolib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">seismolib package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-seismolib.geo">seismolib.geo module</a><ul>
<li><a class="reference internal" href="#seismolib.geo.deg2km"><code class="docutils literal notranslate"><span class="pre">deg2km()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.geo.epdist"><code class="docutils literal notranslate"><span class="pre">epdist()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.geo.km2deg"><code class="docutils literal notranslate"><span class="pre">km2deg()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.geo.mercator_aspect"><code class="docutils literal notranslate"><span class="pre">mercator_aspect()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.geo.polygon"><code class="docutils literal notranslate"><span class="pre">polygon()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.gk">seismolib.gk module</a><ul>
<li><a class="reference internal" href="#seismolib.gk.ll2xy"><code class="docutils literal notranslate"><span class="pre">ll2xy()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.gk.xy2ll"><code class="docutils literal notranslate"><span class="pre">xy2ll()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.signal">seismolib.signal module</a><ul>
<li><a class="reference internal" href="#seismolib.signal.bp"><code class="docutils literal notranslate"><span class="pre">bp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.envelope_hilbert"><code class="docutils literal notranslate"><span class="pre">envelope_hilbert()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.envelope_rms"><code class="docutils literal notranslate"><span class="pre">envelope_rms()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.freq2time"><code class="docutils literal notranslate"><span class="pre">freq2time()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.hp"><code class="docutils literal notranslate"><span class="pre">hp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.lp"><code class="docutils literal notranslate"><span class="pre">lp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.psdf_fft"><code class="docutils literal notranslate"><span class="pre">psdf_fft()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.rmean"><code class="docutils literal notranslate"><span class="pre">rmean()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.rot_hcmp"><code class="docutils literal notranslate"><span class="pre">rot_hcmp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.rtrend"><code class="docutils literal notranslate"><span class="pre">rtrend()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.rtrend2"><code class="docutils literal notranslate"><span class="pre">rtrend2()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.seismometer_decon"><code class="docutils literal notranslate"><span class="pre">seismometer_decon()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.smooth"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.taper_cosine"><code class="docutils literal notranslate"><span class="pre">taper_cosine()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.taper_hamming"><code class="docutils literal notranslate"><span class="pre">taper_hamming()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.taper_hanning"><code class="docutils literal notranslate"><span class="pre">taper_hanning()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.signal.time2freq"><code class="docutils literal notranslate"><span class="pre">time2freq()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.times">seismolib.times module</a><ul>
<li><a class="reference internal" href="#seismolib.times.date"><code class="docutils literal notranslate"><span class="pre">date()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.date2jul"><code class="docutils literal notranslate"><span class="pre">date2jul()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.date_time"><code class="docutils literal notranslate"><span class="pre">date_time()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.gmtime"><code class="docutils literal notranslate"><span class="pre">gmtime()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.is_leapyear"><code class="docutils literal notranslate"><span class="pre">is_leapyear()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.jul2date"><code class="docutils literal notranslate"><span class="pre">jul2date()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.time_range"><code class="docutils literal notranslate"><span class="pre">time_range()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.timegm"><code class="docutils literal notranslate"><span class="pre">timegm()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.times.to_datetime"><code class="docutils literal notranslate"><span class="pre">to_datetime()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.utils">seismolib.utils module</a><ul>
<li><a class="reference internal" href="#seismolib.utils.chk_value"><code class="docutils literal notranslate"><span class="pre">chk_value()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.utils.deg2dms"><code class="docutils literal notranslate"><span class="pre">deg2dms()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.utils.dms2deg"><code class="docutils literal notranslate"><span class="pre">dms2deg()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.utils.i2s"><code class="docutils literal notranslate"><span class="pre">i2s()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.utils.split_list"><code class="docutils literal notranslate"><span class="pre">split_list()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.vmodels">seismolib.vmodels module</a><ul>
<li><a class="reference internal" href="#seismolib.vmodels.brocher_density"><code class="docutils literal notranslate"><span class="pre">brocher_density()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_ak135"><code class="docutils literal notranslate"><span class="pre">vmodel_ak135()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_hinet"><code class="docutils literal notranslate"><span class="pre">vmodel_hinet()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_iasp91"><code class="docutils literal notranslate"><span class="pre">vmodel_iasp91()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_jma"><code class="docutils literal notranslate"><span class="pre">vmodel_jma()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_prem"><code class="docutils literal notranslate"><span class="pre">vmodel_prem()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodels.vmodel_tohoku"><code class="docutils literal notranslate"><span class="pre">vmodel_tohoku()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#seismolib-traveltime-module">seismolib.traveltime module</a><ul>
<li><a class="reference internal" href="#seismolib.traveltime.traveltime_jma"><code class="docutils literal notranslate"><span class="pre">traveltime_jma()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.plots">seismolib.plot module</a><ul>
<li><a class="reference internal" href="#seismolib.plots.eqplot"><code class="docutils literal notranslate"><span class="pre">eqplot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.get_color"><code class="docutils literal notranslate"><span class="pre">get_color()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.get_font"><code class="docutils literal notranslate"><span class="pre">get_font()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.get_pen"><code class="docutils literal notranslate"><span class="pre">get_pen()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.hsv2rgb"><code class="docutils literal notranslate"><span class="pre">hsv2rgb()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.plot_mech"><code class="docutils literal notranslate"><span class="pre">plot_mech()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.pygmt_config"><code class="docutils literal notranslate"><span class="pre">pygmt_config()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.pygmt_config_S"><code class="docutils literal notranslate"><span class="pre">pygmt_config_S()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.record_section"><code class="docutils literal notranslate"><span class="pre">record_section()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.spectrogram"><code class="docutils literal notranslate"><span class="pre">spectrogram()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.surface"><code class="docutils literal notranslate"><span class="pre">surface()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.wiggleplot"><code class="docutils literal notranslate"><span class="pre">wiggleplot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plots.xyz2grd"><code class="docutils literal notranslate"><span class="pre">xyz2grd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib.movie">seismolib.movie module</a><ul>
<li><a class="reference internal" href="#seismolib.movie.gif_movie"><code class="docutils literal notranslate"><span class="pre">gif_movie()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-seismolib">Module contents</a><ul>
<li><a class="reference internal" href="#seismolib.bp"><code class="docutils literal notranslate"><span class="pre">bp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.brocher_density"><code class="docutils literal notranslate"><span class="pre">brocher_density()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.chk_value"><code class="docutils literal notranslate"><span class="pre">chk_value()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.date"><code class="docutils literal notranslate"><span class="pre">date()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.date2jul"><code class="docutils literal notranslate"><span class="pre">date2jul()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.date_time"><code class="docutils literal notranslate"><span class="pre">date_time()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.deg2dms"><code class="docutils literal notranslate"><span class="pre">deg2dms()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.deg2km"><code class="docutils literal notranslate"><span class="pre">deg2km()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.dms2deg"><code class="docutils literal notranslate"><span class="pre">dms2deg()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.envelope_hilbert"><code class="docutils literal notranslate"><span class="pre">envelope_hilbert()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.envelope_rms"><code class="docutils literal notranslate"><span class="pre">envelope_rms()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.epdist"><code class="docutils literal notranslate"><span class="pre">epdist()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.eqplot"><code class="docutils literal notranslate"><span class="pre">eqplot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.freq2time"><code class="docutils literal notranslate"><span class="pre">freq2time()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.get_color"><code class="docutils literal notranslate"><span class="pre">get_color()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.get_font"><code class="docutils literal notranslate"><span class="pre">get_font()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.get_pen"><code class="docutils literal notranslate"><span class="pre">get_pen()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.gif_movie"><code class="docutils literal notranslate"><span class="pre">gif_movie()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.gmtime"><code class="docutils literal notranslate"><span class="pre">gmtime()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.hp"><code class="docutils literal notranslate"><span class="pre">hp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.hsv2rgb"><code class="docutils literal notranslate"><span class="pre">hsv2rgb()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.i2s"><code class="docutils literal notranslate"><span class="pre">i2s()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.is_leapyear"><code class="docutils literal notranslate"><span class="pre">is_leapyear()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.jul2date"><code class="docutils literal notranslate"><span class="pre">jul2date()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.km2deg"><code class="docutils literal notranslate"><span class="pre">km2deg()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.ll2xy"><code class="docutils literal notranslate"><span class="pre">ll2xy()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.lp"><code class="docutils literal notranslate"><span class="pre">lp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.mercator_aspect"><code class="docutils literal notranslate"><span class="pre">mercator_aspect()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.plot_mech"><code class="docutils literal notranslate"><span class="pre">plot_mech()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.polygon"><code class="docutils literal notranslate"><span class="pre">polygon()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.psdf_fft"><code class="docutils literal notranslate"><span class="pre">psdf_fft()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.pygmt_config"><code class="docutils literal notranslate"><span class="pre">pygmt_config()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.pygmt_config_S"><code class="docutils literal notranslate"><span class="pre">pygmt_config_S()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.record_section"><code class="docutils literal notranslate"><span class="pre">record_section()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.rmean"><code class="docutils literal notranslate"><span class="pre">rmean()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.rot_hcmp"><code class="docutils literal notranslate"><span class="pre">rot_hcmp()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.rtrend"><code class="docutils literal notranslate"><span class="pre">rtrend()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.rtrend2"><code class="docutils literal notranslate"><span class="pre">rtrend2()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.seismometer_decon"><code class="docutils literal notranslate"><span class="pre">seismometer_decon()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.smooth"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.spectrogram"><code class="docutils literal notranslate"><span class="pre">spectrogram()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.split_list"><code class="docutils literal notranslate"><span class="pre">split_list()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.surface"><code class="docutils literal notranslate"><span class="pre">surface()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.taper_cosine"><code class="docutils literal notranslate"><span class="pre">taper_cosine()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.taper_hamming"><code class="docutils literal notranslate"><span class="pre">taper_hamming()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.taper_hanning"><code class="docutils literal notranslate"><span class="pre">taper_hanning()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.time2freq"><code class="docutils literal notranslate"><span class="pre">time2freq()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.time_range"><code class="docutils literal notranslate"><span class="pre">time_range()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.timegm"><code class="docutils literal notranslate"><span class="pre">timegm()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.to_datetime"><code class="docutils literal notranslate"><span class="pre">to_datetime()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.traveltime_jma"><code class="docutils literal notranslate"><span class="pre">traveltime_jma()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_ak135"><code class="docutils literal notranslate"><span class="pre">vmodel_ak135()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_hinet"><code class="docutils literal notranslate"><span class="pre">vmodel_hinet()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_iasp91"><code class="docutils literal notranslate"><span class="pre">vmodel_iasp91()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_jma"><code class="docutils literal notranslate"><span class="pre">vmodel_jma()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_prem"><code class="docutils literal notranslate"><span class="pre">vmodel_prem()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.vmodel_tohoku"><code class="docutils literal notranslate"><span class="pre">vmodel_tohoku()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.wiggleplot"><code class="docutils literal notranslate"><span class="pre">wiggleplot()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.xy2ll"><code class="docutils literal notranslate"><span class="pre">xy2ll()</span></code></a></li>
<li><a class="reference internal" href="#seismolib.xyz2grd"><code class="docutils literal notranslate"><span class="pre">xyz2grd()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">seismolib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">seismolib package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/seismolib.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seismolib-package">
<h1>seismolib package<a class="headerlink" href="#seismolib-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-seismolib.geo">
<span id="seismolib-geo-module"></span><h2>seismolib.geo module<a class="headerlink" href="#module-seismolib.geo" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.geo.deg2km">
<span class="sig-prename descclassname"><span class="pre">seismolib.geo.</span></span><span class="sig-name descname"><span class="pre">deg2km</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.geo.deg2km" title="Link to this definition"></a></dt>
<dd><p>角距離(deg.)を距離(km)に変換する．オプションで地球サイズ`R0`も変更できる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deg</strong> (<em>number</em>) – 角距離</p></li>
<li><p><strong>R0</strong> (<em>number</em><em>, </em><em>optional</em>) – 地球半径(6371kmがデフォルト）</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.geo.epdist">
<span class="sig-prename descclassname"><span class="pre">seismolib.geo.</span></span><span class="sig-name descname"><span class="pre">epdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_elliptic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.geo.epdist" title="Link to this definition"></a></dt>
<dd><p>2組の緯度経度から震央距離・Azimuth・Back Azimuthの計算を行う</p>
<p>定式化は地震の辞典第2版 p.52に基づく．方位角は北から時計回りに測る．
基本的には球面三角法だが，距離が近いときにベッセル楕円体の地心半径を
用いた高精度計算（is_elliptic = True ) も行える．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_lon</strong> (<em>float</em>) – 震源の緯度経度 (degrees)</p></li>
<li><p><strong>event_lat</strong> (<em>float</em>) – 震源の緯度経度 (degrees)</p></li>
<li><p><strong>station_lon</strong> (<em>float</em>) – 観測点緯度経度（degrees）</p></li>
<li><p><strong>station_lat</strong> (<em>float</em>) – 観測点緯度経度（degrees）</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(dist (km), azimuth (degree), back_azimuth (degree))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epdist</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
<span class="go">(143.38265213187395, 38.860270806043971, 219.4410056442396)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epdist</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(143.30662405398323, 38.986394043530979, 219.5645515565227)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.geo.km2deg">
<span class="sig-prename descclassname"><span class="pre">seismolib.geo.</span></span><span class="sig-name descname"><span class="pre">km2deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.geo.km2deg" title="Link to this definition"></a></dt>
<dd><p>距離(km)を角距離(deg.)に変換する．オプションで地球サイズ`R0`も変更できる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>km</strong> (<em>number</em>) – 距離</p></li>
<li><p><strong>R0</strong> (<em>number</em><em>, </em><em>optional</em>) – 地球半径(6371kmがデフォルト）</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.geo.mercator_aspect">
<span class="sig-prename descclassname"><span class="pre">seismolib.geo.</span></span><span class="sig-name descname"><span class="pre">mercator_aspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08181919104281579</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.geo.mercator_aspect" title="Link to this definition"></a></dt>
<dd><p>PyGMT形式で与えられた地図領域 [lon0, lon1, lat0, lat1] から，
メルカトル投影された地図の縦横比Rを返す．
ただし離心率 <cite>e</cite> のデフォルト値は地球のものが仮定されている．
他惑星で利用するときはこの値をオプション変数として変更すること．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.geo.polygon">
<span class="sig-prename descclassname"><span class="pre">seismolib.geo.</span></span><span class="sig-name descname"><span class="pre">polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.geo.polygon" title="Link to this definition"></a></dt>
<dd><p>Return if (x,y) is inside a polygon having vertices at (px(:), py(:))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Location to be investigated</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Location to be investigated</p></li>
<li><p><strong>px</strong> (<em>Array-like</em>) – Polygon vertices</p></li>
<li><p><strong>py</strong> (<em>Array-like</em>) – Polygon vertices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if (x,y) is inside the polygon</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polygon</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polygon</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seismolib.gk">
<span id="seismolib-gk-module"></span><h2>seismolib.gk module<a class="headerlink" href="#module-seismolib.gk" title="Link to this heading"></a></h2>
<p>Gauss-Krugeur projection based on GSI’s formula</p>
<p><a class="reference external" href="http://goo.gl/qoYh8t">http://goo.gl/qoYh8t</a>, <a class="reference external" href="http://goo.gl/mSuDxm">http://goo.gl/mSuDxm</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.gk.ll2xy">
<span class="sig-prename descclassname"><span class="pre">seismolib.gk.</span></span><span class="sig-name descname"><span class="pre">ll2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.gk.ll2xy" title="Link to this definition"></a></dt>
<dd><p>Convert longitude &amp; latitude (deg.) to x, y (km)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>float</em>) – longitude and latitude (degrees) to be converted to cartesian</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – longitude and latitude (degrees) to be converted to cartesian</p></li>
<li><p><strong>clon</strong> (<em>float</em>) – longitude and latitude of reference point (deg.)</p></li>
<li><p><strong>clat</strong> (<em>float</em>) – longitude and latitude of reference point (deg.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x, y</strong> – Northing/Easting coordinate (km) measured from (clon, clat)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ll2xy</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mf">144.25</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(-111.061047360681, -20.38320805146281)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.gk.xy2ll">
<span class="sig-prename descclassname"><span class="pre">seismolib.gk.</span></span><span class="sig-name descname"><span class="pre">xy2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.gk.xy2ll" title="Link to this definition"></a></dt>
<dd><p>Convert x &amp; y (km) to x, y (km). Inverse of ll2xy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Northing &amp; easting coordinate location measured from reference (km)</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Northing &amp; easting coordinate location measured from reference (km)</p></li>
<li><p><strong>clon</strong> (<em>float</em>) – longitude and latitude of reference point (degrees)</p></li>
<li><p><strong>clat</strong> (<em>float</em>) – longitude and latitude of reference point (degrees)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lon, lat</strong> – longitude and latitude (degrees)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="o">-</span><span class="mf">111.061047360681</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.38320805146281</span><span class="p">,</span> <span class="mf">144.25</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(144.0, 43.0)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seismolib.signal">
<span id="seismolib-signal-module"></span><h2>seismolib.signal module<a class="headerlink" href="#module-seismolib.signal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.bp">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">bp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.bp" title="Link to this definition"></a></dt>
<dd><p>band-pass filter</p>
<p>Apply band-pass filter of nord-th order,
with the corner frequencies of (fl, fh).
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fl</strong> (<em>float</em>) – lower corner frequency of the band pass (the same unit w/sfreq)</p></li>
<li><p><strong>fh</strong> (<em>float</em>) – lower corner frequency of the band pass (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.envelope_hilbert">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">envelope_hilbert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.envelope_hilbert" title="Link to this definition"></a></dt>
<dd><p>ヒルベルト変換による時系列dのエンベロープ
dの解析信号の絶対値として定義される．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>envelope of input data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.envelope_rms">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">envelope_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.envelope_rms" title="Link to this definition"></a></dt>
<dd><p>半値幅 hw のRMS平均による時系列 d のエンベロープ</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>hw</strong> (<em>half-window length</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>envelope of input data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.freq2time">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">freq2time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'negative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.freq2time" title="Link to this definition"></a></dt>
<dd><p>Inverse of time2freq</p>
<p>計算の定義は</p>
<dl class="simple">
<dt>$$</dt><dd><p>u(t) = sum_{i=0}^{N-1} u(f_i) exp[-j 2 pi f_i t] dt</p>
</dd>
</dl>
<p>$$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>array-like</em><em>, </em><em>complex</em>) – fourier spectrum of u</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usualy in seconds)</p></li>
<li><p><strong>nfft</strong> (<em>integer</em><em> (</em><em>optional</em><em>)</em>) – size of fft. Power of 2 is highly recommended for efficient computation
default: (len(u)-1)*2</p></li>
<li><p><strong>sign</strong> (<em>str</em>) – ‘positive’ or ‘negative</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>u</strong> (<em>array-like, real</em>) – time series</p></li>
<li><p><strong>t</strong> (<em>array-like, real</em>) – time, starting from zero</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.hp">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">hp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.hp" title="Link to this definition"></a></dt>
<dd><p>high-pass filter</p>
<p>Apply low-pass filter of nord-th order,
with the corner frequencies of fh.
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em><em>)</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fl</strong> (<em>float</em>) – corner frequency of the high-pass filter (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.lp">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">lp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.lp" title="Link to this definition"></a></dt>
<dd><p>low-pass filter</p>
<p>Apply low-pass filter of nord-th order,
with the corner frequencies of fh.
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em><em>)</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fh</strong> (<em>float</em>) – Corner frequency of the low-pass filter (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.psdf_fft">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">psdf_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.psdf_fft" title="Link to this definition"></a></dt>
<dd><p>Power spectral density function by means of FFT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>array-like</em>) – time-series data of which PSDF is estimated.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usually in sec.)</p></li>
<li><p><strong>nfft</strong> (<em>int</em><em>, </em><em>optional</em>) – number of samples to perform FFT. Power of 2 is highly recommended.</p></li>
<li><p><strong>taper</strong> (<em>str</em><em>, </em><em>optional</em>) – type of tapering window. ‘Hanning’/’Hamming’/’Cosine’
if taper is not None, Hamming is used as default taper window.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Taper shape parameter for the ‘Cosine’ type taper.
See <cite>taper_cosine</cite> for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.rmean">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">rmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.rmean" title="Link to this definition"></a></dt>
<dd><p>remove mean from array u</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data with mean subtracted</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.rot_hcmp">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">rot_hcmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmpaz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmpaz_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.rot_hcmp" title="Link to this definition"></a></dt>
<dd><p>水平動2成分データを rot_angle 方向に回転する．</p>
<p>角度はすべて北を0として時計回りに測る．入力地震動の成分は
- x: 北から cmpaz_x 方向
- y: 北から cmpaz_y 方向
の成分を仮定する．わざわざ角度表現で2成分を独立にあらわしているのは，
地震計の設置方位が南北東西から回転していることがあること，さらに
cmpaz_y = cmpaz + 90
であるとは限らないためである．たとえば東西成分の+-を逆につないだらcmpaz=-90である．
NE→RT変換には rot_angle を back_azimuth - 180° とする</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_x</strong> (<em>array-like</em>) – 入力2成分データ．
標準的には南北と東西だがその方向はcmpaz_x, cmpaz_yで定義</p></li>
<li><p><strong>data_y</strong> (<em>array-like</em>) – 入力2成分データ．
標準的には南北と東西だがその方向はcmpaz_x, cmpaz_yで定義</p></li>
<li><p><strong>cmpaz_x</strong> (<em>float</em><em> or </em><em>int</em>) – 入力データの角度．北から時計回り．
南北動なら0，東西動なら90が入る．</p></li>
<li><p><strong>cmpaz_y</strong> (<em>float</em><em> or </em><em>int</em>) – 入力データの角度．北から時計回り．
南北動なら0，東西動なら90が入る．</p></li>
<li><p><strong>rot_angle</strong> (<em>float</em><em> or </em><em>int</em>) – data_x, data_y をそれぞれ この角度だけ時計周りに回転する．</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data_v, data_w</strong> – それぞれdata_x, data_yを回転したもの</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.rtrend">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">rtrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.rtrend" title="Link to this definition"></a></dt>
<dd><p>remove linear trend from array u
This function is equivalent to scipy.signal.detrend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detrended data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.rtrend2">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">rtrend2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.rtrend2" title="Link to this definition"></a></dt>
<dd><p>Remove linear trend from array y
The trend is estimated by least square method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detrended data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.seismometer_decon">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">seismometer_decon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.008333333333333333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7071067811865475</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.seismometer_decon" title="Link to this definition"></a></dt>
<dd><p>Inverse filterにより地震計特性の逆畳み込みと，広帯域特性の畳み込みを同時に行う．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>array-like</em>) – 地震波形データ</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – サンプリング間隔</p></li>
<li><p><strong>f0</strong> (<em>floats</em>) – 入力記録の地震計の自然周波数とダンピング係数．デフォルトはHi-netの値</p></li>
<li><p><strong>h0</strong> (<em>floats</em>) – 入力記録の地震計の自然周波数とダンピング係数．デフォルトはHi-netの値</p></li>
<li><p><strong>f1</strong> (<em>floats</em>) – 出力記録の地震計の自然周波数とダンピング係数．デフォルトは120s, critical damping</p></li>
<li><p><strong>h1</strong> (<em>floats</em>) – 出力記録の地震計の自然周波数とダンピング係数．デフォルトは120s, critical damping</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dat</strong> – 畳み込み後のデータ．元データと同じ長さ．</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Maeda, T., Obara, K., Furumura, T., &amp; Saito, T. (2011).
Interference of long-period seismic wavefield observed by dense Hi-net array in Japan,
Journal of Geophysical Research: Solid Earth, 116, B10303, doi:10.1029/2011JB008464.
http://doi.org/10.1029/2011JB008464</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.smooth">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.smooth" title="Link to this definition"></a></dt>
<dd><p>リスト x の半値幅 hw の移動平均を計算する．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>hw</strong> (<em>integer</em>) – half-window</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – smoothed array of x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.taper_cosine">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">taper_cosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.taper_cosine" title="Link to this definition"></a></dt>
<dd><p>Apply cosine (Tukey) taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>r</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>0-100</em><em>)</em>) – Fraction of the window inside the cosine taperd region in %
0 is box-car window
100 returns Hann window</p></li>
<li><p><strong>nh</strong> (<em>integer</em>) – instead of r, users may specify the length of taper region
by specifing number of samples in half-window nh</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.taper_hamming">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">taper_hamming</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.taper_hamming" title="Link to this definition"></a></dt>
<dd><p>Apply Hamming taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.taper_hanning">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">taper_hanning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.taper_hanning" title="Link to this definition"></a></dt>
<dd><p>Apply Hanning (Han) taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.signal.time2freq">
<span class="sig-prename descclassname"><span class="pre">seismolib.signal.</span></span><span class="sig-name descname"><span class="pre">time2freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'positive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.signal.time2freq" title="Link to this definition"></a></dt>
<dd><p>Fourier transform of time series (real-valued) u(t) with sampling interval dt</p>
<p>計算の定義は
$$</p>
<blockquote>
<div><p>u(f) = sum_{i=0}^{N-1} u(t_i) exp[j 2 pi f t_i] dt</p>
</div></blockquote>
<p>$$
ただし，オプション変数 sign=’negative’ のときには指数部の符号がマイナスになる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>array-like</em>) – time series data (real)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usualy in seconds)</p></li>
<li><p><strong>nfft</strong> (<em>integer</em><em> (</em><em>optional</em><em>)</em>) – size of fft. Power of 2 is highly recommended for efficient computation
default: len(u)</p></li>
<li><p><strong>sign</strong> (<em>str</em>) – ‘positive’ or ‘negative</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c</strong> (<em>array-like (Complex)</em>) – Fourier transform of u</p></li>
<li><p><strong>f</strong> (<em>array-like (size: nfft/2+1)</em>) – Frequency (1/(unit of dt))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-seismolib.times">
<span id="seismolib-times-module"></span><h2>seismolib.times module<a class="headerlink" href="#module-seismolib.times" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.date">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.date" title="Link to this definition"></a></dt>
<dd><p>日付のみの情報からdatetime.dateオブジェクトを返す．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>month</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>day</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.date object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.date2jul">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">date2jul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.date2jul" title="Link to this definition"></a></dt>
<dd><p>Returns julian day (day of the year).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>date</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – A datetime object of which the julian day is calculated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>julday</strong> – Julian day of the year</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date2jul</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>
<span class="go">365</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.date_time">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">date_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.date_time" title="Link to this definition"></a></dt>
<dd><p>日時情報からdatetime.datetimeオブジェクトを返す．secondが実数でもOK</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>month</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>day</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>hour</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>minute</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>second</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>str</em>) – 秒数は実数でも可．整数部とマイクロ秒部に分割してdatetimeに入力する．</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.datetime object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date_time</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">datetime.datetime(2021, 10, 1, 0, 0, 0, 500000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.gmtime">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">gmtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.gmtime" title="Link to this definition"></a></dt>
<dd><p>Inverse of timegm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<em>float</em><em> or </em><em>int</em>) – seconds from 1970-01-01 00:00:00 (UTC)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>date</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.datetime</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.is_leapyear">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">is_leapyear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.is_leapyear" title="Link to this definition"></a></dt>
<dd><p>True if the input yr is a leap year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yr</strong> (<em>int</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.jul2date">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">jul2date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">julday</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.jul2date" title="Link to this definition"></a></dt>
<dd><p>Calculate datetime from year and julian day</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>integer</em>)</p></li>
<li><p><strong>juday</strong> (<em>integer</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>datetime.datetime</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jul2date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">366</span><span class="p">)</span>
<span class="go">datetime.datetime(2000, 12, 31, 0, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.time_range">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">time_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">datetime.timedelta(days=1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.time_range" title="Link to this definition"></a></dt>
<dd><p>datetime.date オブジェクトの start, stop の間を step 間隔で返すジェネレータ
yieldされるのは常にdatetime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – start day</p></li>
<li><p><strong>stop</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – end day</p></li>
<li><p><strong>step</strong> (<em>datetime.timdedelta</em>) – step between start and stop</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>datetime.datetime</em></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">tim</span> <span class="ow">in</span> <span class="n">time_range</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span>
<span class="go">2020-10-05 00:00:00</span>
<span class="go">2020-10-06 00:00:00</span>
<span class="go">2020-10-07 00:00:00</span>
</pre></div>
</div>
<section id="file">
<h3>File<a class="headerlink" href="#file" title="Link to this heading"></a></h3>
<p>seismolabpy/times.py</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.timegm">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">timegm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.timegm" title="Link to this definition"></a></dt>
<dd><p>Returns seconds from 1970-01-01 00:00:00 (UTC)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tim</strong> (<em>float</em>) – time to be converted</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>tim</strong> – time in seconds</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.times.to_datetime">
<span class="sig-prename descclassname"><span class="pre">seismolib.times.</span></span><span class="sig-name descname"><span class="pre">to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datetime64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.times.to_datetime" title="Link to this definition"></a></dt>
<dd><p>convert numpy.datetime64 to datetime.datetime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>datetime64</strong> (<em>numpy.datetime64</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>datetime.datetime</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://gist.github.com/blaylockbk/1677b446bc741ee2db3e943ab7e4cabd">https://gist.github.com/blaylockbk/1677b446bc741ee2db3e943ab7e4cabd</a></p>
</div>
</dd></dl>

</section>
<section id="module-seismolib.utils">
<span id="seismolib-utils-module"></span><h2>seismolib.utils module<a class="headerlink" href="#module-seismolib.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.utils.chk_value">
<span class="sig-prename descclassname"><span class="pre">seismolib.utils.</span></span><span class="sig-name descname"><span class="pre">chk_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.utils.chk_value" title="Link to this definition"></a></dt>
<dd><p>伝統的なエラー判定「未定義の場合に -12345.0 を取る」のような条件を判断する．</p>
<p>未定義定数 err に値が十分近い場合には Noneを，そうでない場合には varを返す．
整数・実数・複素数・文字列に対応．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>complex</em><em> or </em><em>str</em>) – 検査値</p></li>
<li><p><strong>err</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>complex</em><em> or </em><em>str</em>) – エラー判定定数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – var or None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same type with var</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="go">3.1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="s1">&#39;3.1&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="go">&#39;3.1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.utils.deg2dms">
<span class="sig-prename descclassname"><span class="pre">seismolib.utils.</span></span><span class="sig-name descname"><span class="pre">deg2dms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.utils.deg2dms" title="Link to this definition"></a></dt>
<dd><p>10進法のdegree を60進法の degree(d):minute(m):second に変換する</p>
<section id="paremters">
<h3>Paremters<a class="headerlink" href="#paremters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>deg<span class="classifier">number</span></dt><dd><p>degree in decimal</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(d, m, s)</strong> – where d, m, s means degree, minute, and second
d and m should be integer, while s is float.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of numbers</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.utils.dms2deg">
<span class="sig-prename descclassname"><span class="pre">seismolib.utils.</span></span><span class="sig-name descname"><span class="pre">dms2deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.utils.dms2deg" title="Link to this definition"></a></dt>
<dd><p>60進法の degree(d):minute(m):second を 10進法のdegreeに変換する</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>number</em>) – degree. can be either positive or negative</p></li>
<li><p><strong>m</strong> (<em>number</em>) – minutes. usually positive</p></li>
<li><p><strong>s</strong> (<em>number</em>) – seconds. usually positive</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deg</strong> – degrees in decimal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.utils.i2s">
<span class="sig-prename descclassname"><span class="pre">seismolib.utils.</span></span><span class="sig-name descname"><span class="pre">i2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.utils.i2s" title="Link to this definition"></a></dt>
<dd><p>integer to string</p>
<p>整数値 i を桁数 w の文字列にする．桁数がwに満たない場合は左にゼロを埋める．
桁数が指定されていない場合は必要な最小限の長さの文字列になる．
桁数が指定され，かつ足りない場合はAssertionErrorになる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – integer to be converted</p></li>
<li><p><strong>w</strong> (<em>int</em>) – column width</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – string representing integer i</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">&#39;00003&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;-01&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="o">-</span><span class="mi">32351</span><span class="p">)</span>
<span class="go">&#39;-32351</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.utils.split_list">
<span class="sig-prename descclassname"><span class="pre">seismolib.utils.</span></span><span class="sig-name descname"><span class="pre">split_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.utils.split_list" title="Link to this definition"></a></dt>
<dd><p>split list into lists whose length of n</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">split_list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">li</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seismolib.vmodels">
<span id="seismolib-vmodels-module"></span><h2>seismolib.vmodels module<a class="headerlink" href="#module-seismolib.vmodels" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.brocher_density">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">brocher_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.brocher_density" title="Link to this definition"></a></dt>
<dd><p>Brocher (2005)’s empirical relationship between vp and density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vp</strong> (<em>float</em>) – P-wave velocity in km/s</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rho</strong> – density in g/cm^3</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_ak135">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_ak135</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_ak135" title="Link to this definition"></a></dt>
<dd><p>AK135 velocity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vp, vs</strong> (<em>floats</em>) – wavespeeds of P and S waves in km/s</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – density in g/cm^3</p></li>
<li><p><strong>qp, qs</strong> (<em>float</em>) – Quality factors of P and S waves</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_hinet">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_hinet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_hinet" title="Link to this definition"></a></dt>
<dd><p>Hi-net速度構造</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_iasp91">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_iasp91</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_iasp91" title="Link to this definition"></a></dt>
<dd><p>iasp91 velcity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds in km/s</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Kennet and Engdahl (1991) GJI 105, 429-465, <a class="reference external" href="https://doi.org/10.1111/j.1365-246X.1991.tb06724.x">https://doi.org/10.1111/j.1365-246X.1991.tb06724.x</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_jma">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_jma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2001'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_jma" title="Link to this definition"></a></dt>
<dd><p>JMA2001 velocity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – depth in km</p></li>
<li><p><strong>model</strong> (<em>str</em>) – velocity model version (‘2001’, ‘2020a’, ‘2020b’, ‘2020c’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves in km/s</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_prem">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_prem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_prem" title="Link to this definition"></a></dt>
<dd><p>Return the modified PREM 1D velocity structure</p>
<p>Compared to the original model of the Diewonski and Anderson (1981),
the seawater layer is substituted to a crustal structure if type=’modified’ is given:</p>
<blockquote>
<div><p>rho=2.6 g/cm^3, vp=5.8 km/s, vs=3.2 km/s qmu=600, qkappa = 57823</p>
</div></blockquote>
<p>Or, ‘</p>
<p>This routine returns Q_P and Q_S rather than Q_kappa and Q_mu, by converting using
a formula of (9.59) &amp; (9.60) of Dahlen and Tromp (1998)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vp, vs</strong> (<em>floats</em>) – wavespeeds of P and S waves</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – density in g/cm^3</p></li>
<li><p><strong>qp, qs</strong> (<em>float</em>) – Quality factor of P and S waves</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodels.vmodel_tohoku">
<span class="sig-prename descclassname"><span class="pre">seismolib.vmodels.</span></span><span class="sig-name descname"><span class="pre">vmodel_tohoku</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodels.vmodel_tohoku" title="Link to this definition"></a></dt>
<dd><p>東北大ルーチン速度構造</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="seismolib-traveltime-module">
<h2>seismolib.traveltime module<a class="headerlink" href="#seismolib-traveltime-module" title="Link to this heading"></a></h2>
<dl class="py function" id="module-seismolib.traveltime">
<dt class="sig sig-object py" id="seismolib.traveltime.traveltime_jma">
<span class="sig-prename descclassname"><span class="pre">seismolib.traveltime.</span></span><span class="sig-name descname"><span class="pre">traveltime_jma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.traveltime.traveltime_jma" title="Link to this definition"></a></dt>
<dd><p>JMA2001構造による走時計算</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>Float</em>) – 震央距離 (km)</p></li>
<li><p><strong>depth</strong> (<em>Float</em>) – 震源深さ (km)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tp</strong> (<em>Float</em>) – P波到達時間 (s)</p></li>
<li><p><strong>ts</strong> (<em>Float</em>) – S波到達時間 (s)</p></li>
<li><p><strong>theta</strong> (<em>Float</em>) – 震源射出角 (deg)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-seismolib.plots">
<span id="seismolib-plot-module"></span><h2>seismolib.plot module<a class="headerlink" href="#module-seismolib.plots" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.eqplot">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">eqplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dep=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsize=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsize=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magsize=&lt;function</span> <span class="pre">_magnitude_size&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap='roma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zdiv=5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.eqplot" title="Link to this definition"></a></dt>
<dd><p>地震活動の断面図プロットを作成する．
magsize には マグニチュードからサイズ（cm）への変換を行う関数を与える．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – 地震カタログデータフレーム．longitude, latitude, depth, magnitude の列を持つ必要がある．</p></li>
<li><p><strong>region</strong> (<em>array-like</em>) – [lon0, lon1, lat0, lat1] の順で与える．デフォルトはデータフレームの範囲．</p></li>
<li><p><strong>dep</strong> (<em>array-like</em>) – [z0, z1] の順で与える．デフォルトはデータフレームの範囲．</p></li>
<li><p><strong>xsize</strong> (<em>float</em>) – 横幅（cm）</p></li>
<li><p><strong>zsize</strong> (<em>float</em>) – 高さ（cm）</p></li>
<li><p><strong>magsize</strong> (<em>function</em>) – マグニチュードからサイズ（cm）への変換関数</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – カラーマップ名</p></li>
<li><p><strong>zdiv</strong> (<em>int</em>) – カラーマップの深さ方向の分割数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.get_color">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">get_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.get_color" title="Link to this definition"></a></dt>
<dd><p>PyGMTのフォーマットで色を返す</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – 色を表す文字列，もしくはRGBのリスト，もしくは整数（色番号）</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>) – 透明度（0-100）</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyGMTの色表現</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.get_font">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">get_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fontsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.get_font" title="Link to this definition"></a></dt>
<dd><p>Return font specification in PyGMT format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fontsize</strong> (<em>int</em><em> or </em><em>str</em>) – Font size</p></li>
<li><p><strong>font</strong> (<em>str</em>) – Font</p></li>
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – Font color</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.get_pen">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">get_pen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.get_pen" title="Link to this definition"></a></dt>
<dd><p>Return pen type in PyGMT format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>float</em><em> or </em><em>str</em>) – Pen width</p></li>
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – Pen color</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>) – Transparency (0-100; Default: None)</p></li>
<li><p><strong>dash</strong> (<em>str</em>) – Dash style (Default: None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.hsv2rgb">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">hsv2rgb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.hsv2rgb" title="Link to this definition"></a></dt>
<dd><p>HSV to RGB conversion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>float</em>) – Hue (0-360)</p></li>
<li><p><strong>s</strong> (<em>float</em>) – Saturation (0-1)</p></li>
<li><p><strong>v</strong> (<em>float</em>) – Value (0-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RGB color in PyGMT format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.plot">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('lin',</span> <span class="pre">'lin')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_script</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.plot" title="Link to this definition"></a></dt>
<dd><p>Easy plot by using pyGMT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – 独立変数</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> (or </em><em>tuple</em><em> of </em><em>array-like</em><em>)</em>) – 従属変数．
同じ独立変数に対する複数の従属変数を <cite>(y1, y2)</cite> のようにタプルで与えられる．</p></li>
<li><p><strong>region</strong> (<em>array</em><em> or </em><em>tuple</em>) – (xmin, xmax, ymin, ymax) ．デフォルトでは自動設定．</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – [x軸ラベル, y軸ラベル]</p></li>
<li><p><strong>title</strong> (<em>str</em>) – プロットタイトル（上部に表示）</p></li>
<li><p><strong>symbol</strong> (<em>str</em>) – デフォルト（’-’）で線，それ以外で◯．他のシンボルは未対応</p></li>
<li><p><strong>axis</strong> (<em>array</em><em> (or </em><em>tuple</em><em>) of </em><em>str</em>) – x軸とy軸それぞれ ‘lin’ or ‘log’ で軸の線形か対数かを指定．デフォルトは線形．</p></li>
<li><p><strong>show_script</strong> (<em>bool</em>) – 自動生成したスクリプトを表示する．デフォルトは False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.plot_mech">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">plot_mech</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rake</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">takeoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressionfill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'250/50/150&#64;50'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarizationfill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.plot_mech" title="Link to this definition"></a></dt>
<dd><p>Plot focal mechanism with azimuth, takeoff and polarization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strike</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>dip</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>rake</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>azimuth</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>takeoff</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>polarization</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>compressionfill</strong> (<em>str</em>) – Fill color for the compression quadrants</p></li>
<li><p><strong>polarizationfill</strong> (<em>str</em>) – Fill color for the observation points with compressional polarity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.pygmt_config">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">pygmt_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.pygmt_config" title="Link to this definition"></a></dt>
<dd><p>標準的なGMT設定．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>bool</em>) – Trueの場合は，設定文字列を返す．デフォルトは False</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>with pygmt_config():</dt><dd><p>fig.XXX()</p>
</dd>
</dl>
<p>のように with 句と使う．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.pygmt_config_S">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">pygmt_config_S</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.pygmt_config_S" title="Link to this definition"></a></dt>
<dd><p>標準的なGMT設定．(Small igure version)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>bool</em>) – Trueの場合は，設定文字列を返す．デフォルトは False</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>with pygmt_config():</dt><dd><p>fig.XXX()</p>
</dd>
</dl>
<p>のように with 句と使う．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.record_section">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">record_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'horizontal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('134/49/74',</span> <span class="pre">'85/80/39',</span> <span class="pre">'63/70/138',</span> <span class="pre">'111/47/127',</span> <span class="pre">'44/86/105')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stcode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">360]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.record_section" title="Link to this definition"></a></dt>
<dd><p>Plot record section of the seismogram: PyGMT version</p>
<p>簡易プロットで良いなら，<cite>obspy.Stream.plot(type=’section’)</cite> のほうが高速に動作する．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>obspy.Stream</em>) – 地震波形データ．
その中のTraceにstats.distance (m) もしくは stats.sac.dist (km) が入っていることが前提</p></li>
<li><p><strong>dist</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – プロットする距離範囲 (km) の下限と上限を list か tuple で与える．
デフォルトはstreamに含まれる距離の最小値から最大値まで</p></li>
<li><p><strong>tim</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – プロットする時間範囲 (s) の下限と上限を list か tuple で与える．
デフォルトはstreamに含まれる時間の最小値から最大値まで</p></li>
<li><p><strong>size</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – <cite>(width, height)</cite> を cm 単位で与える．デフォルトは <cite>(20, 12)</cite></p></li>
<li><p><strong>decimation</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – プロットを高速化するために，波形をdecimationごとに間引いてプロットする．
たとえばdecimation=10なら波形の 0, 10, 20 … サンプルが飛び飛びにプロットされる．
デフォルトは1（間引きなし）.
1つの地震波形のサンプル数が数千程度以下におさまる程度にするのがよい．サンプル数が多くなると極端に遅くなる．</p></li>
<li><p><strong>transparency</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – 波形の透明度．0-100の数値で与える．デフォルトは0（不透明）</p></li>
<li><p><strong>orientation</strong> (<em>'horizontal'</em><em> or </em><em>'vertical'</em>) – horizontal は 横軸に距離，縦軸に時間（デフォルト：ObsPyと同じ），vertical はその逆</p></li>
<li><p><strong>otim</strong> (<em>datetime.datetime</em><em> (</em><em>optional</em><em>)</em>) – 時刻 0 の時間（地震発生時刻）を強制的に otim にずらす
デフォルトでは trace.stats.starttime を 時間 t = trace.stats.sac.b のであるとして，t=0
に相当する時刻がotimに相当する．これは，eventdataの仕様に合わせてある．</p></li>
<li><p><strong>filt</strong> (<em>'raw'</em><em>, </em><em>'bp'</em><em> ,</em><em>'lp'</em><em> , </em><em>'hp'</em><em> (</em><em>optional</em><em>)</em>) – フィルタの種類．デフォルトは ‘raw’ （生波形=なにもしない）．
bp の場合には fc = (fl, fh) で低周波と高周波の下限上限を Hz で，
lp と hp の場合には fc に上限もしくは下限の周波数を Hz で，それぞれ与える．</p></li>
<li><p><strong>fc</strong> (<em>フィルタの周波数パラメタ．</em><em>(</em><em>optional</em><em>)</em>) – <cite>filt</cite> パラメタの説明参照．</p></li>
<li><p><strong>nord</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – フィルタの次数．デフォルトは 2</p></li>
<li><p><strong>twopass</strong> (<em>Bool</em><em> (</em><em>optional</em><em>)</em>) – 前後からのゼロ位相フィルタを適用するかどうか．デフォルトはTrue
Trueの場合，フィルタが2回適用されるため，フィルタ次数は <cite>nord * 2</cite> になる．</p></li>
<li><p><strong>scale</strong> (<em>'auto'</em><em> or </em><em>flort</em><em> (</em><em>optional</em><em>)</em>) – ‘auto’ の場合，波形ごとの最大値で規格化される．
数値で与えられた場合，波形の単位におけるその数値が基準振幅となる．デフォルトは’auto’</p></li>
<li><p><strong>mag</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – scaleで指定された倍率を全体に <cite>mag</cite> 倍する．主に’auto’のときに全体の倍率を調整する用途．
デフォルトは 1</p></li>
<li><p><strong>color</strong> (<em>array-like</em><em> of </em><em>str</em><em> or </em><em>str</em><em>(</em><em>optional</em><em>)</em>) – 波形の色．単一の文字列で与えられたとき（例：’black’）はすべてその色になる．
list/tupleで与えられたとき（[‘black’, ‘blue’, ‘red’, ‘orange’]）波形の色はリスト内の
色を周期的に用いる．
デフォルトは (“134/49/74”, “85/80/39”, “63/70/138”, “111/47/127”, “44/86/105”)</p></li>
<li><p><strong>plot_stcode</strong> (<em>Bool</em><em> (</em><em>optional</em><em>)</em>) – 観測点名をプロットする場合 True にする．デフォルトはFalse</p></li>
<li><p><strong>reduce</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – 数値が与えられたとき，それを km/s 単位のレデュース速度とみなして波形をレデュースする．
デフォルトは None （レデュースしない）</p></li>
<li><p><strong>azimuth</strong> (<em>array-like</em>) – (az1, az2) という長さ2のlist/tupleが与えられたとき，震源から見た観測点の方位角（Azimuth）が
az1 &lt;= azimuth &lt; az2 の観測点だけプロットする．</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.spectrogram">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abyss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_cont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.spectrogram" title="Link to this definition"></a></dt>
<dd><p>Plot spectrogram of a given trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>Obspy trace</em><em> (or </em><em>stream</em><em>)</em>) – if this is stream, use trace[0] data.
trace must contain <cite>trace.stats.delta</cite> and <cite>trace.stats.npts</cite> headers.</p></li>
<li><p><strong>nwin</strong> (<em>int</em>) – length of time window to estimate spectrum, in number of samples.</p></li>
<li><p><strong>wshift</strong> (<em>int</em>) – length of time shift to calculate spectorgram, in number of samples.</p></li>
<li><p><strong>nfft</strong> (<em>int</em>) – length of time window length to perform FFT, in number of samples .
nfft must be equall or larger than nwin.
It is most computationally efficient if nfft is power of 2
(like 256, 512, 1024 … )</p></li>
<li><p><strong>frange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – frequency range to be plotted. Given in (f_minimum, f_maximum)
if it is None (default), frequency range is automatically detemined
by using nfft and sampling interval of trace.</p></li>
<li><p><strong>trange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – temporal range to be plotted.
if it is None (default), temporal range is automatically detemined
by using length of the given trace.</p></li>
<li><p><strong>prange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – minimum and maximum of the colar pallete.</p></li>
<li><p><strong>flog</strong> (<em>Bool</em>) – Plot frequency axis in logarithmic scale. True for default.</p></li>
<li><p><strong>plog</strong> (<em>Bool</em>) – Plot power spectral density function (color) in logarithmic scale. True for default.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – Specify color map. Default is ‘abyss’</p></li>
<li><p><strong>cmap_cont</strong> (<em>Bool</em>) – Use continuous color palette. Default is True.</p></li>
<li><p><strong>return_data</strong> (<em>Bool</em>) – if this value is set to True, this funciton returns (fig, time, frequency, PSDF)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>PyGMT.Figure</em>) – PyGMT figure object.</p></li>
<li><p><strong>time</strong> (<em>array</em>) – time axis of the spectrogram</p></li>
<li><p><strong>frequency</strong> (<em>array</em>) – frequency axis of the spectrogram</p></li>
<li><p><strong>PSDF</strong> (<em>array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.surface">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.surface" title="Link to this definition"></a></dt>
<dd><p>Convert xyz data to grd data by usin PyGMT.surface module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>z</strong> (<em>array-like</em>) – two-dimensional array
z[nx,ny]</p></li>
<li><p><strong>region</strong> (<em>array-like</em><em> or </em><em>str</em>) – GMT’s region setting (automatically detemined by default)</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – grid spacing. default is x[1]-x[0] and y[1]-y[0]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – grid spacing. default is x[1]-x[0] and y[1]-y[0]</p></li>
<li><p><strong>tension</strong> (<em>float</em>) – tension parameter of PyGMT.surface</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pygmt.grddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.wiggleplot">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">wiggleplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time</span> <span class="pre">[s]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'traces'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.wiggleplot" title="Link to this definition"></a></dt>
<dd><p>Wiggle plot of the seismogram.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the detailed documentation will be available later.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plots.xyz2grd">
<span class="sig-prename descclassname"><span class="pre">seismolib.plots.</span></span><span class="sig-name descname"><span class="pre">xyz2grd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plots.xyz2grd" title="Link to this definition"></a></dt>
<dd><p>Convert xyz data to grd data by usin PyGMT.xyz2grd module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>z</strong> (<em>array-like</em>) – two-dimensional array
z[nx,ny]</p></li>
<li><p><strong>region</strong> (<em>array-like</em><em> or </em><em>str</em>) – GMT’s region setting (automatically detemined by default)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pygmt.grddata</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-seismolib.movie">
<span id="seismolib-movie-module"></span><h2>seismolib.movie module<a class="headerlink" href="#module-seismolib.movie" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.movie.gif_movie">
<span class="sig-prename descclassname"><span class="pre">seismolib.movie.</span></span><span class="sig-name descname"><span class="pre">gif_movie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">720</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.5c'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.movie.gif_movie" title="Link to this definition"></a></dt>
<dd><p>PyGMTのFigureオブジェクトのリストからGifアニメーションを作成する．Jupyter Notebook上で表示されるオブジェクトを返す．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figs</strong> (<em>list</em><em> of </em><em>Figure</em>) – PyGMTのFigureオブジェクトのリスト</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – 解像度 (default: 720)</p></li>
<li><p><strong>crop</strong> (<em>str</em><em>, </em><em>optional</em>) – 余白のトリミング量 (default: ‘0.5c’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>HTML</strong> – Gifアニメーション</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>IPython.display.HTML</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-seismolib">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-seismolib" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismolib.bp">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">bp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.bp" title="Link to this definition"></a></dt>
<dd><p>band-pass filter</p>
<p>Apply band-pass filter of nord-th order,
with the corner frequencies of (fl, fh).
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fl</strong> (<em>float</em>) – lower corner frequency of the band pass (the same unit w/sfreq)</p></li>
<li><p><strong>fh</strong> (<em>float</em>) – lower corner frequency of the band pass (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.brocher_density">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">brocher_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.brocher_density" title="Link to this definition"></a></dt>
<dd><p>Brocher (2005)’s empirical relationship between vp and density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vp</strong> (<em>float</em>) – P-wave velocity in km/s</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rho</strong> – density in g/cm^3</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.chk_value">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">chk_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.chk_value" title="Link to this definition"></a></dt>
<dd><p>伝統的なエラー判定「未定義の場合に -12345.0 を取る」のような条件を判断する．</p>
<p>未定義定数 err に値が十分近い場合には Noneを，そうでない場合には varを返す．
整数・実数・複素数・文字列に対応．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>complex</em><em> or </em><em>str</em>) – 検査値</p></li>
<li><p><strong>err</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>complex</em><em> or </em><em>str</em>) – エラー判定定数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – var or None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>same type with var</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="go">3.1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chk_value</span><span class="p">(</span><span class="s1">&#39;3.1&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="go">&#39;3.1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.date">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.date" title="Link to this definition"></a></dt>
<dd><p>日付のみの情報からdatetime.dateオブジェクトを返す．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>month</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>day</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.date object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.date2jul">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">date2jul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.date2jul" title="Link to this definition"></a></dt>
<dd><p>Returns julian day (day of the year).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>date</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – A datetime object of which the julian day is calculated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>julday</strong> – Julian day of the year</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date2jul</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>
<span class="go">365</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.date_time">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">date_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.date_time" title="Link to this definition"></a></dt>
<dd><p>日時情報からdatetime.datetimeオブジェクトを返す．secondが実数でもOK</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>month</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>day</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>hour</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>minute</strong> (<em>int</em><em> or </em><em>str</em>)</p></li>
<li><p><strong>second</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>str</em>) – 秒数は実数でも可．整数部とマイクロ秒部に分割してdatetimeに入力する．</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.datetime object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">date_time</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">datetime.datetime(2021, 10, 1, 0, 0, 0, 500000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.deg2dms">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">deg2dms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.deg2dms" title="Link to this definition"></a></dt>
<dd><p>10進法のdegree を60進法の degree(d):minute(m):second に変換する</p>
<section id="id1">
<h3>Paremters<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>deg<span class="classifier">number</span></dt><dd><p>degree in decimal</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(d, m, s)</strong> – where d, m, s means degree, minute, and second
d and m should be integer, while s is float.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of numbers</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.deg2km">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">deg2km</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.deg2km" title="Link to this definition"></a></dt>
<dd><p>角距離(deg.)を距離(km)に変換する．オプションで地球サイズ`R0`も変更できる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deg</strong> (<em>number</em>) – 角距離</p></li>
<li><p><strong>R0</strong> (<em>number</em><em>, </em><em>optional</em>) – 地球半径(6371kmがデフォルト）</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.dms2deg">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">dms2deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.dms2deg" title="Link to this definition"></a></dt>
<dd><p>60進法の degree(d):minute(m):second を 10進法のdegreeに変換する</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>number</em>) – degree. can be either positive or negative</p></li>
<li><p><strong>m</strong> (<em>number</em>) – minutes. usually positive</p></li>
<li><p><strong>s</strong> (<em>number</em>) – seconds. usually positive</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deg</strong> – degrees in decimal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.envelope_hilbert">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">envelope_hilbert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.envelope_hilbert" title="Link to this definition"></a></dt>
<dd><p>ヒルベルト変換による時系列dのエンベロープ
dの解析信号の絶対値として定義される．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>envelope of input data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.envelope_rms">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">envelope_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.envelope_rms" title="Link to this definition"></a></dt>
<dd><p>半値幅 hw のRMS平均による時系列 d のエンベロープ</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>hw</strong> (<em>half-window length</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>envelope of input data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.epdist">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">epdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_elliptic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.epdist" title="Link to this definition"></a></dt>
<dd><p>2組の緯度経度から震央距離・Azimuth・Back Azimuthの計算を行う</p>
<p>定式化は地震の辞典第2版 p.52に基づく．方位角は北から時計回りに測る．
基本的には球面三角法だが，距離が近いときにベッセル楕円体の地心半径を
用いた高精度計算（is_elliptic = True ) も行える．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_lon</strong> (<em>float</em>) – 震源の緯度経度 (degrees)</p></li>
<li><p><strong>event_lat</strong> (<em>float</em>) – 震源の緯度経度 (degrees)</p></li>
<li><p><strong>station_lon</strong> (<em>float</em>) – 観測点緯度経度（degrees）</p></li>
<li><p><strong>station_lat</strong> (<em>float</em>) – 観測点緯度経度（degrees）</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(dist (km), azimuth (degree), back_azimuth (degree))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epdist</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
<span class="go">(143.38265213187395, 38.860270806043971, 219.4410056442396)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epdist</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(143.30662405398323, 38.986394043530979, 219.5645515565227)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.eqplot">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">eqplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dep=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsize=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsize=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magsize=&lt;function</span> <span class="pre">_magnitude_size&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap='roma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zdiv=5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.eqplot" title="Link to this definition"></a></dt>
<dd><p>地震活動の断面図プロットを作成する．
magsize には マグニチュードからサイズ（cm）への変換を行う関数を与える．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – 地震カタログデータフレーム．longitude, latitude, depth, magnitude の列を持つ必要がある．</p></li>
<li><p><strong>region</strong> (<em>array-like</em>) – [lon0, lon1, lat0, lat1] の順で与える．デフォルトはデータフレームの範囲．</p></li>
<li><p><strong>dep</strong> (<em>array-like</em>) – [z0, z1] の順で与える．デフォルトはデータフレームの範囲．</p></li>
<li><p><strong>xsize</strong> (<em>float</em>) – 横幅（cm）</p></li>
<li><p><strong>zsize</strong> (<em>float</em>) – 高さ（cm）</p></li>
<li><p><strong>magsize</strong> (<em>function</em>) – マグニチュードからサイズ（cm）への変換関数</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – カラーマップ名</p></li>
<li><p><strong>zdiv</strong> (<em>int</em>) – カラーマップの深さ方向の分割数</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.freq2time">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">freq2time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'negative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.freq2time" title="Link to this definition"></a></dt>
<dd><p>Inverse of time2freq</p>
<p>計算の定義は</p>
<dl class="simple">
<dt>$$</dt><dd><p>u(t) = sum_{i=0}^{N-1} u(f_i) exp[-j 2 pi f_i t] dt</p>
</dd>
</dl>
<p>$$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>array-like</em><em>, </em><em>complex</em>) – fourier spectrum of u</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usualy in seconds)</p></li>
<li><p><strong>nfft</strong> (<em>integer</em><em> (</em><em>optional</em><em>)</em>) – size of fft. Power of 2 is highly recommended for efficient computation
default: (len(u)-1)*2</p></li>
<li><p><strong>sign</strong> (<em>str</em>) – ‘positive’ or ‘negative</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>u</strong> (<em>array-like, real</em>) – time series</p></li>
<li><p><strong>t</strong> (<em>array-like, real</em>) – time, starting from zero</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.get_color">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">get_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.get_color" title="Link to this definition"></a></dt>
<dd><p>PyGMTのフォーマットで色を返す</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – 色を表す文字列，もしくはRGBのリスト，もしくは整数（色番号）</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>) – 透明度（0-100）</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyGMTの色表現</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.get_font">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">get_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fontsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.get_font" title="Link to this definition"></a></dt>
<dd><p>Return font specification in PyGMT format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fontsize</strong> (<em>int</em><em> or </em><em>str</em>) – Font size</p></li>
<li><p><strong>font</strong> (<em>str</em>) – Font</p></li>
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – Font color</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.get_pen">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">get_pen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.get_pen" title="Link to this definition"></a></dt>
<dd><p>Return pen type in PyGMT format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>float</em><em> or </em><em>str</em>) – Pen width</p></li>
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>tuple</em><em> or </em><em>int</em><em> or </em><em>float</em>) – Pen color</p></li>
<li><p><strong>transp</strong> (<em>int</em><em> or </em><em>float</em>) – Transparency (0-100; Default: None)</p></li>
<li><p><strong>dash</strong> (<em>str</em>) – Dash style (Default: None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.gif_movie">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">gif_movie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">720</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.5c'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.gif_movie" title="Link to this definition"></a></dt>
<dd><p>PyGMTのFigureオブジェクトのリストからGifアニメーションを作成する．Jupyter Notebook上で表示されるオブジェクトを返す．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figs</strong> (<em>list</em><em> of </em><em>Figure</em>) – PyGMTのFigureオブジェクトのリスト</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – 解像度 (default: 720)</p></li>
<li><p><strong>crop</strong> (<em>str</em><em>, </em><em>optional</em>) – 余白のトリミング量 (default: ‘0.5c’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>HTML</strong> – Gifアニメーション</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>IPython.display.HTML</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.gmtime">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">gmtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.gmtime" title="Link to this definition"></a></dt>
<dd><p>Inverse of timegm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<em>float</em><em> or </em><em>int</em>) – seconds from 1970-01-01 00:00:00 (UTC)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>date</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.datetime</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.hp">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">hp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.hp" title="Link to this definition"></a></dt>
<dd><p>high-pass filter</p>
<p>Apply low-pass filter of nord-th order,
with the corner frequencies of fh.
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em><em>)</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fl</strong> (<em>float</em>) – corner frequency of the high-pass filter (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.hsv2rgb">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">hsv2rgb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.hsv2rgb" title="Link to this definition"></a></dt>
<dd><p>HSV to RGB conversion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>float</em>) – Hue (0-360)</p></li>
<li><p><strong>s</strong> (<em>float</em>) – Saturation (0-1)</p></li>
<li><p><strong>v</strong> (<em>float</em>) – Value (0-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RGB color in PyGMT format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.i2s">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">i2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.i2s" title="Link to this definition"></a></dt>
<dd><p>integer to string</p>
<p>整数値 i を桁数 w の文字列にする．桁数がwに満たない場合は左にゼロを埋める．
桁数が指定されていない場合は必要な最小限の長さの文字列になる．
桁数が指定され，かつ足りない場合はAssertionErrorになる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – integer to be converted</p></li>
<li><p><strong>w</strong> (<em>int</em>) – column width</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – string representing integer i</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">&#39;00003&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;-01&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i2s</span><span class="p">(</span><span class="o">-</span><span class="mi">32351</span><span class="p">)</span>
<span class="go">&#39;-32351</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.is_leapyear">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">is_leapyear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.is_leapyear" title="Link to this definition"></a></dt>
<dd><p>True if the input yr is a leap year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>yr</strong> (<em>int</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.jul2date">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">jul2date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">julday</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.jul2date" title="Link to this definition"></a></dt>
<dd><p>Calculate datetime from year and julian day</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>integer</em>)</p></li>
<li><p><strong>juday</strong> (<em>integer</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>datetime.datetime</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jul2date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">366</span><span class="p">)</span>
<span class="go">datetime.datetime(2000, 12, 31, 0, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.km2deg">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">km2deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.km2deg" title="Link to this definition"></a></dt>
<dd><p>距離(km)を角距離(deg.)に変換する．オプションで地球サイズ`R0`も変更できる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>km</strong> (<em>number</em>) – 距離</p></li>
<li><p><strong>R0</strong> (<em>number</em><em>, </em><em>optional</em>) – 地球半径(6371kmがデフォルト）</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.ll2xy">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">ll2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.ll2xy" title="Link to this definition"></a></dt>
<dd><p>Convert longitude &amp; latitude (deg.) to x, y (km)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>float</em>) – longitude and latitude (degrees) to be converted to cartesian</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – longitude and latitude (degrees) to be converted to cartesian</p></li>
<li><p><strong>clon</strong> (<em>float</em>) – longitude and latitude of reference point (deg.)</p></li>
<li><p><strong>clat</strong> (<em>float</em>) – longitude and latitude of reference point (deg.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x, y</strong> – Northing/Easting coordinate (km) measured from (clon, clat)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ll2xy</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mf">144.25</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(-111.061047360681, -20.38320805146281)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.lp">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">lp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.lp" title="Link to this definition"></a></dt>
<dd><p>low-pass filter</p>
<p>Apply low-pass filter of nord-th order,
with the corner frequencies of fh.
Essentially same with obspy.signal.filter.bandpass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em><em>)</em>) – Original data to be filtered</p></li>
<li><p><strong>sfreq</strong> (<em>float/int</em>) – Sampling frequency of data (usually in Hz)</p></li>
<li><p><strong>fh</strong> (<em>float</em>) – Corner frequency of the low-pass filter (the same unit w/sfreq)</p></li>
<li><p><strong>nord</strong> (<em>int</em>) – filter order</p></li>
<li><p><strong>twopass</strong> (<em>bool</em>) – apply the same filter from positive and netgative directions
to realize zero-phase filter.
In this case, filter order will be doubled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.mercator_aspect">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">mercator_aspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08181919104281579</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.mercator_aspect" title="Link to this definition"></a></dt>
<dd><p>PyGMT形式で与えられた地図領域 [lon0, lon1, lat0, lat1] から，
メルカトル投影された地図の縦横比Rを返す．
ただし離心率 <cite>e</cite> のデフォルト値は地球のものが仮定されている．
他惑星で利用するときはこの値をオプション変数として変更すること．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plot">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('lin',</span> <span class="pre">'lin')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_script</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plot" title="Link to this definition"></a></dt>
<dd><p>Easy plot by using pyGMT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – 独立変数</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> (or </em><em>tuple</em><em> of </em><em>array-like</em><em>)</em>) – 従属変数．
同じ独立変数に対する複数の従属変数を <cite>(y1, y2)</cite> のようにタプルで与えられる．</p></li>
<li><p><strong>region</strong> (<em>array</em><em> or </em><em>tuple</em>) – (xmin, xmax, ymin, ymax) ．デフォルトでは自動設定．</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – [x軸ラベル, y軸ラベル]</p></li>
<li><p><strong>title</strong> (<em>str</em>) – プロットタイトル（上部に表示）</p></li>
<li><p><strong>symbol</strong> (<em>str</em>) – デフォルト（’-’）で線，それ以外で◯．他のシンボルは未対応</p></li>
<li><p><strong>axis</strong> (<em>array</em><em> (or </em><em>tuple</em><em>) of </em><em>str</em>) – x軸とy軸それぞれ ‘lin’ or ‘log’ で軸の線形か対数かを指定．デフォルトは線形．</p></li>
<li><p><strong>show_script</strong> (<em>bool</em>) – 自動生成したスクリプトを表示する．デフォルトは False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.plot_mech">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">plot_mech</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rake</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">takeoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressionfill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'250/50/150&#64;50'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarizationfill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.plot_mech" title="Link to this definition"></a></dt>
<dd><p>Plot focal mechanism with azimuth, takeoff and polarization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strike</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>dip</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>rake</strong> (<em>floats</em>) – Strike, dip and rake angles of the focal mechanism</p></li>
<li><p><strong>azimuth</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>takeoff</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>polarization</strong> (<em>list</em><em> of </em><em>floats</em><em> (</em><em>optional</em><em>)</em>) – Azimuth, takeoff and polarization angles of the radiation pattern
if these lists are not provided, only the focal mechanism is plotted.</p></li>
<li><p><strong>compressionfill</strong> (<em>str</em>) – Fill color for the compression quadrants</p></li>
<li><p><strong>polarizationfill</strong> (<em>str</em>) – Fill color for the observation points with compressional polarity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.polygon">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.polygon" title="Link to this definition"></a></dt>
<dd><p>Return if (x,y) is inside a polygon having vertices at (px(:), py(:))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Location to be investigated</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Location to be investigated</p></li>
<li><p><strong>px</strong> (<em>Array-like</em>) – Polygon vertices</p></li>
<li><p><strong>py</strong> (<em>Array-like</em>) – Polygon vertices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if (x,y) is inside the polygon</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polygon</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polygon</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.psdf_fft">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">psdf_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.psdf_fft" title="Link to this definition"></a></dt>
<dd><p>Power spectral density function by means of FFT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>array-like</em>) – time-series data of which PSDF is estimated.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usually in sec.)</p></li>
<li><p><strong>nfft</strong> (<em>int</em><em>, </em><em>optional</em>) – number of samples to perform FFT. Power of 2 is highly recommended.</p></li>
<li><p><strong>taper</strong> (<em>str</em><em>, </em><em>optional</em>) – type of tapering window. ‘Hanning’/’Hamming’/’Cosine’
if taper is not None, Hamming is used as default taper window.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Taper shape parameter for the ‘Cosine’ type taper.
See <cite>taper_cosine</cite> for detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.pygmt_config">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">pygmt_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.pygmt_config" title="Link to this definition"></a></dt>
<dd><p>標準的なGMT設定．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>bool</em>) – Trueの場合は，設定文字列を返す．デフォルトは False</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>with pygmt_config():</dt><dd><p>fig.XXX()</p>
</dd>
</dl>
<p>のように with 句と使う．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.pygmt_config_S">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">pygmt_config_S</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.pygmt_config_S" title="Link to this definition"></a></dt>
<dd><p>標準的なGMT設定．(Small igure version)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>bool</em>) – Trueの場合は，設定文字列を返す．デフォルトは False</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>with pygmt_config():</dt><dd><p>fig.XXX()</p>
</dd>
</dl>
<p>のように with 句と使う．</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.record_section">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">record_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'horizontal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twopass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('134/49/74',</span> <span class="pre">'85/80/39',</span> <span class="pre">'63/70/138',</span> <span class="pre">'111/47/127',</span> <span class="pre">'44/86/105')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_stcode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">360]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.record_section" title="Link to this definition"></a></dt>
<dd><p>Plot record section of the seismogram: PyGMT version</p>
<p>簡易プロットで良いなら，<cite>obspy.Stream.plot(type=’section’)</cite> のほうが高速に動作する．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>obspy.Stream</em>) – 地震波形データ．
その中のTraceにstats.distance (m) もしくは stats.sac.dist (km) が入っていることが前提</p></li>
<li><p><strong>dist</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – プロットする距離範囲 (km) の下限と上限を list か tuple で与える．
デフォルトはstreamに含まれる距離の最小値から最大値まで</p></li>
<li><p><strong>tim</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – プロットする時間範囲 (s) の下限と上限を list か tuple で与える．
デフォルトはstreamに含まれる時間の最小値から最大値まで</p></li>
<li><p><strong>size</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – <cite>(width, height)</cite> を cm 単位で与える．デフォルトは <cite>(20, 12)</cite></p></li>
<li><p><strong>decimation</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – プロットを高速化するために，波形をdecimationごとに間引いてプロットする．
たとえばdecimation=10なら波形の 0, 10, 20 … サンプルが飛び飛びにプロットされる．
デフォルトは1（間引きなし）.
1つの地震波形のサンプル数が数千程度以下におさまる程度にするのがよい．サンプル数が多くなると極端に遅くなる．</p></li>
<li><p><strong>transparency</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – 波形の透明度．0-100の数値で与える．デフォルトは0（不透明）</p></li>
<li><p><strong>orientation</strong> (<em>'horizontal'</em><em> or </em><em>'vertical'</em>) – horizontal は 横軸に距離，縦軸に時間（デフォルト：ObsPyと同じ），vertical はその逆</p></li>
<li><p><strong>otim</strong> (<em>datetime.datetime</em><em> (</em><em>optional</em><em>)</em>) – 時刻 0 の時間（地震発生時刻）を強制的に otim にずらす
デフォルトでは trace.stats.starttime を 時間 t = trace.stats.sac.b のであるとして，t=0
に相当する時刻がotimに相当する．これは，eventdataの仕様に合わせてある．</p></li>
<li><p><strong>filt</strong> (<em>'raw'</em><em>, </em><em>'bp'</em><em> ,</em><em>'lp'</em><em> , </em><em>'hp'</em><em> (</em><em>optional</em><em>)</em>) – フィルタの種類．デフォルトは ‘raw’ （生波形=なにもしない）．
bp の場合には fc = (fl, fh) で低周波と高周波の下限上限を Hz で，
lp と hp の場合には fc に上限もしくは下限の周波数を Hz で，それぞれ与える．</p></li>
<li><p><strong>fc</strong> (<em>フィルタの周波数パラメタ．</em><em>(</em><em>optional</em><em>)</em>) – <cite>filt</cite> パラメタの説明参照．</p></li>
<li><p><strong>nord</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – フィルタの次数．デフォルトは 2</p></li>
<li><p><strong>twopass</strong> (<em>Bool</em><em> (</em><em>optional</em><em>)</em>) – 前後からのゼロ位相フィルタを適用するかどうか．デフォルトはTrue
Trueの場合，フィルタが2回適用されるため，フィルタ次数は <cite>nord * 2</cite> になる．</p></li>
<li><p><strong>scale</strong> (<em>'auto'</em><em> or </em><em>flort</em><em> (</em><em>optional</em><em>)</em>) – ‘auto’ の場合，波形ごとの最大値で規格化される．
数値で与えられた場合，波形の単位におけるその数値が基準振幅となる．デフォルトは’auto’</p></li>
<li><p><strong>mag</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – scaleで指定された倍率を全体に <cite>mag</cite> 倍する．主に’auto’のときに全体の倍率を調整する用途．
デフォルトは 1</p></li>
<li><p><strong>color</strong> (<em>array-like</em><em> of </em><em>str</em><em> or </em><em>str</em><em>(</em><em>optional</em><em>)</em>) – 波形の色．単一の文字列で与えられたとき（例：’black’）はすべてその色になる．
list/tupleで与えられたとき（[‘black’, ‘blue’, ‘red’, ‘orange’]）波形の色はリスト内の
色を周期的に用いる．
デフォルトは (“134/49/74”, “85/80/39”, “63/70/138”, “111/47/127”, “44/86/105”)</p></li>
<li><p><strong>plot_stcode</strong> (<em>Bool</em><em> (</em><em>optional</em><em>)</em>) – 観測点名をプロットする場合 True にする．デフォルトはFalse</p></li>
<li><p><strong>reduce</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – 数値が与えられたとき，それを km/s 単位のレデュース速度とみなして波形をレデュースする．
デフォルトは None （レデュースしない）</p></li>
<li><p><strong>azimuth</strong> (<em>array-like</em>) – (az1, az2) という長さ2のlist/tupleが与えられたとき，震源から見た観測点の方位角（Azimuth）が
az1 &lt;= azimuth &lt; az2 の観測点だけプロットする．</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.rmean">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">rmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.rmean" title="Link to this definition"></a></dt>
<dd><p>remove mean from array u</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data with mean subtracted</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.rot_hcmp">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">rot_hcmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmpaz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmpaz_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.rot_hcmp" title="Link to this definition"></a></dt>
<dd><p>水平動2成分データを rot_angle 方向に回転する．</p>
<p>角度はすべて北を0として時計回りに測る．入力地震動の成分は
- x: 北から cmpaz_x 方向
- y: 北から cmpaz_y 方向
の成分を仮定する．わざわざ角度表現で2成分を独立にあらわしているのは，
地震計の設置方位が南北東西から回転していることがあること，さらに
cmpaz_y = cmpaz + 90
であるとは限らないためである．たとえば東西成分の+-を逆につないだらcmpaz=-90である．
NE→RT変換には rot_angle を back_azimuth - 180° とする</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_x</strong> (<em>array-like</em>) – 入力2成分データ．
標準的には南北と東西だがその方向はcmpaz_x, cmpaz_yで定義</p></li>
<li><p><strong>data_y</strong> (<em>array-like</em>) – 入力2成分データ．
標準的には南北と東西だがその方向はcmpaz_x, cmpaz_yで定義</p></li>
<li><p><strong>cmpaz_x</strong> (<em>float</em><em> or </em><em>int</em>) – 入力データの角度．北から時計回り．
南北動なら0，東西動なら90が入る．</p></li>
<li><p><strong>cmpaz_y</strong> (<em>float</em><em> or </em><em>int</em>) – 入力データの角度．北から時計回り．
南北動なら0，東西動なら90が入る．</p></li>
<li><p><strong>rot_angle</strong> (<em>float</em><em> or </em><em>int</em>) – data_x, data_y をそれぞれ この角度だけ時計周りに回転する．</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data_v, data_w</strong> – それぞれdata_x, data_yを回転したもの</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.rtrend">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">rtrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.rtrend" title="Link to this definition"></a></dt>
<dd><p>remove linear trend from array u
This function is equivalent to scipy.signal.detrend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detrended data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.rtrend2">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">rtrend2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.rtrend2" title="Link to this definition"></a></dt>
<dd><p>Remove linear trend from array y
The trend is estimated by least square method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detrended data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.seismometer_decon">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">seismometer_decon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.008333333333333333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7071067811865475</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.seismometer_decon" title="Link to this definition"></a></dt>
<dd><p>Inverse filterにより地震計特性の逆畳み込みと，広帯域特性の畳み込みを同時に行う．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>array-like</em>) – 地震波形データ</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – サンプリング間隔</p></li>
<li><p><strong>f0</strong> (<em>floats</em>) – 入力記録の地震計の自然周波数とダンピング係数．デフォルトはHi-netの値</p></li>
<li><p><strong>h0</strong> (<em>floats</em>) – 入力記録の地震計の自然周波数とダンピング係数．デフォルトはHi-netの値</p></li>
<li><p><strong>f1</strong> (<em>floats</em>) – 出力記録の地震計の自然周波数とダンピング係数．デフォルトは120s, critical damping</p></li>
<li><p><strong>h1</strong> (<em>floats</em>) – 出力記録の地震計の自然周波数とダンピング係数．デフォルトは120s, critical damping</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dat</strong> – 畳み込み後のデータ．元データと同じ長さ．</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Maeda, T., Obara, K., Furumura, T., &amp; Saito, T. (2011).
Interference of long-period seismic wavefield observed by dense Hi-net array in Japan,
Journal of Geophysical Research: Solid Earth, 116, B10303, doi:10.1029/2011JB008464.
http://doi.org/10.1029/2011JB008464</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.smooth">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.smooth" title="Link to this definition"></a></dt>
<dd><p>リスト x の半値幅 hw の移動平均を計算する．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>hw</strong> (<em>integer</em>) – half-window</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – smoothed array of x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.spectrogram">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abyss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_cont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.spectrogram" title="Link to this definition"></a></dt>
<dd><p>Plot spectrogram of a given trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>Obspy trace</em><em> (or </em><em>stream</em><em>)</em>) – if this is stream, use trace[0] data.
trace must contain <cite>trace.stats.delta</cite> and <cite>trace.stats.npts</cite> headers.</p></li>
<li><p><strong>nwin</strong> (<em>int</em>) – length of time window to estimate spectrum, in number of samples.</p></li>
<li><p><strong>wshift</strong> (<em>int</em>) – length of time shift to calculate spectorgram, in number of samples.</p></li>
<li><p><strong>nfft</strong> (<em>int</em>) – length of time window length to perform FFT, in number of samples .
nfft must be equall or larger than nwin.
It is most computationally efficient if nfft is power of 2
(like 256, 512, 1024 … )</p></li>
<li><p><strong>frange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – frequency range to be plotted. Given in (f_minimum, f_maximum)
if it is None (default), frequency range is automatically detemined
by using nfft and sampling interval of trace.</p></li>
<li><p><strong>trange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – temporal range to be plotted.
if it is None (default), temporal range is automatically detemined
by using length of the given trace.</p></li>
<li><p><strong>prange</strong> (<em>list</em><em> of </em><em>two float numbers</em>) – minimum and maximum of the colar pallete.</p></li>
<li><p><strong>flog</strong> (<em>Bool</em>) – Plot frequency axis in logarithmic scale. True for default.</p></li>
<li><p><strong>plog</strong> (<em>Bool</em>) – Plot power spectral density function (color) in logarithmic scale. True for default.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – Specify color map. Default is ‘abyss’</p></li>
<li><p><strong>cmap_cont</strong> (<em>Bool</em>) – Use continuous color palette. Default is True.</p></li>
<li><p><strong>return_data</strong> (<em>Bool</em>) – if this value is set to True, this funciton returns (fig, time, frequency, PSDF)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>PyGMT.Figure</em>) – PyGMT figure object.</p></li>
<li><p><strong>time</strong> (<em>array</em>) – time axis of the spectrogram</p></li>
<li><p><strong>frequency</strong> (<em>array</em>) – frequency axis of the spectrogram</p></li>
<li><p><strong>PSDF</strong> (<em>array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.split_list">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">split_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.split_list" title="Link to this definition"></a></dt>
<dd><p>split list into lists whose length of n</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">split_list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">li</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.surface">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.surface" title="Link to this definition"></a></dt>
<dd><p>Convert xyz data to grd data by usin PyGMT.surface module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>z</strong> (<em>array-like</em>) – two-dimensional array
z[nx,ny]</p></li>
<li><p><strong>region</strong> (<em>array-like</em><em> or </em><em>str</em>) – GMT’s region setting (automatically detemined by default)</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – grid spacing. default is x[1]-x[0] and y[1]-y[0]</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – grid spacing. default is x[1]-x[0] and y[1]-y[0]</p></li>
<li><p><strong>tension</strong> (<em>float</em>) – tension parameter of PyGMT.surface</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pygmt.grddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.taper_cosine">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">taper_cosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.taper_cosine" title="Link to this definition"></a></dt>
<dd><p>Apply cosine (Tukey) taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>array-like</em>) – input data</p></li>
<li><p><strong>r</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>0-100</em><em>)</em>) – Fraction of the window inside the cosine taperd region in %
0 is box-car window
100 returns Hann window</p></li>
<li><p><strong>nh</strong> (<em>integer</em>) – instead of r, users may specify the length of taper region
by specifing number of samples in half-window nh</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.taper_hamming">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">taper_hamming</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.taper_hamming" title="Link to this definition"></a></dt>
<dd><p>Apply Hamming taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.taper_hanning">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">taper_hanning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.taper_hanning" title="Link to this definition"></a></dt>
<dd><p>Apply Hanning (Han) taper to data d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>array-like</em>) – input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dt</strong> (<em>array-like</em>) – data with taper applied</p></li>
<li><p><strong>ta</strong> (<em>array-like</em>) – taper window array (<cite>dt = d * ta</cite>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.time2freq">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">time2freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'positive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.time2freq" title="Link to this definition"></a></dt>
<dd><p>Fourier transform of time series (real-valued) u(t) with sampling interval dt</p>
<p>計算の定義は
$$</p>
<blockquote>
<div><p>u(f) = sum_{i=0}^{N-1} u(t_i) exp[j 2 pi f t_i] dt</p>
</div></blockquote>
<p>$$
ただし，オプション変数 sign=’negative’ のときには指数部の符号がマイナスになる．</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>array-like</em>) – time series data (real)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval (usualy in seconds)</p></li>
<li><p><strong>nfft</strong> (<em>integer</em><em> (</em><em>optional</em><em>)</em>) – size of fft. Power of 2 is highly recommended for efficient computation
default: len(u)</p></li>
<li><p><strong>sign</strong> (<em>str</em>) – ‘positive’ or ‘negative</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c</strong> (<em>array-like (Complex)</em>) – Fourier transform of u</p></li>
<li><p><strong>f</strong> (<em>array-like (size: nfft/2+1)</em>) – Frequency (1/(unit of dt))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.time_range">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">time_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">datetime.timedelta(days=1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.time_range" title="Link to this definition"></a></dt>
<dd><p>datetime.date オブジェクトの start, stop の間を step 間隔で返すジェネレータ
yieldされるのは常にdatetime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – start day</p></li>
<li><p><strong>stop</strong> (<em>datetime.date</em><em> or </em><em>datetime.datetime</em>) – end day</p></li>
<li><p><strong>step</strong> (<em>datetime.timdedelta</em>) – step between start and stop</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>datetime.datetime</em></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">tim</span> <span class="ow">in</span> <span class="n">time_range</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span>
<span class="go">2020-10-05 00:00:00</span>
<span class="go">2020-10-06 00:00:00</span>
<span class="go">2020-10-07 00:00:00</span>
</pre></div>
</div>
<section id="id2">
<h3>File<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>seismolabpy/times.py</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.timegm">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">timegm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.timegm" title="Link to this definition"></a></dt>
<dd><p>Returns seconds from 1970-01-01 00:00:00 (UTC)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tim</strong> (<em>float</em>) – time to be converted</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>tim</strong> – time in seconds</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.to_datetime">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datetime64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.to_datetime" title="Link to this definition"></a></dt>
<dd><p>convert numpy.datetime64 to datetime.datetime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>datetime64</strong> (<em>numpy.datetime64</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>datetime.datetime</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://gist.github.com/blaylockbk/1677b446bc741ee2db3e943ab7e4cabd">https://gist.github.com/blaylockbk/1677b446bc741ee2db3e943ab7e4cabd</a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.traveltime_jma">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">traveltime_jma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.traveltime_jma" title="Link to this definition"></a></dt>
<dd><p>JMA2001構造による走時計算</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>Float</em>) – 震央距離 (km)</p></li>
<li><p><strong>depth</strong> (<em>Float</em>) – 震源深さ (km)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tp</strong> (<em>Float</em>) – P波到達時間 (s)</p></li>
<li><p><strong>ts</strong> (<em>Float</em>) – S波到達時間 (s)</p></li>
<li><p><strong>theta</strong> (<em>Float</em>) – 震源射出角 (deg)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_ak135">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_ak135</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_ak135" title="Link to this definition"></a></dt>
<dd><p>AK135 velocity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vp, vs</strong> (<em>floats</em>) – wavespeeds of P and S waves in km/s</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – density in g/cm^3</p></li>
<li><p><strong>qp, qs</strong> (<em>float</em>) – Quality factors of P and S waves</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_hinet">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_hinet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_hinet" title="Link to this definition"></a></dt>
<dd><p>Hi-net速度構造</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_iasp91">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_iasp91</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_iasp91" title="Link to this definition"></a></dt>
<dd><p>iasp91 velcity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds in km/s</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Kennet and Engdahl (1991) GJI 105, 429-465, <a class="reference external" href="https://doi.org/10.1111/j.1365-246X.1991.tb06724.x">https://doi.org/10.1111/j.1365-246X.1991.tb06724.x</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_jma">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_jma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2001'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_jma" title="Link to this definition"></a></dt>
<dd><p>JMA2001 velocity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – depth in km</p></li>
<li><p><strong>model</strong> (<em>str</em>) – velocity model version (‘2001’, ‘2020a’, ‘2020b’, ‘2020c’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves in km/s</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_prem">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_prem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_prem" title="Link to this definition"></a></dt>
<dd><p>Return the modified PREM 1D velocity structure</p>
<p>Compared to the original model of the Diewonski and Anderson (1981),
the seawater layer is substituted to a crustal structure if type=’modified’ is given:</p>
<blockquote>
<div><p>rho=2.6 g/cm^3, vp=5.8 km/s, vs=3.2 km/s qmu=600, qkappa = 57823</p>
</div></blockquote>
<p>Or, ‘</p>
<p>This routine returns Q_P and Q_S rather than Q_kappa and Q_mu, by converting using
a formula of (9.59) &amp; (9.60) of Dahlen and Tromp (1998)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vp, vs</strong> (<em>floats</em>) – wavespeeds of P and S waves</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – density in g/cm^3</p></li>
<li><p><strong>qp, qs</strong> (<em>float</em>) – Quality factor of P and S waves</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.vmodel_tohoku">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">vmodel_tohoku</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.vmodel_tohoku" title="Link to this definition"></a></dt>
<dd><p>東北大ルーチン速度構造</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>float</em>) – depth in km</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vp, vs</strong> – wavespeeds of P and S waves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.wiggleplot">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">wiggleplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time</span> <span class="pre">[s]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'traces'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.wiggleplot" title="Link to this definition"></a></dt>
<dd><p>Wiggle plot of the seismogram.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the detailed documentation will be available later.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.xy2ll">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">xy2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.xy2ll" title="Link to this definition"></a></dt>
<dd><p>Convert x &amp; y (km) to x, y (km). Inverse of ll2xy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Northing &amp; easting coordinate location measured from reference (km)</p></li>
<li><p><strong>y</strong> (<em>float</em>) – Northing &amp; easting coordinate location measured from reference (km)</p></li>
<li><p><strong>clon</strong> (<em>float</em>) – longitude and latitude of reference point (degrees)</p></li>
<li><p><strong>clat</strong> (<em>float</em>) – longitude and latitude of reference point (degrees)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lon, lat</strong> – longitude and latitude (degrees)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="o">-</span><span class="mf">111.061047360681</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.38320805146281</span><span class="p">,</span> <span class="mf">144.25</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(144.0, 43.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismolib.xyz2grd">
<span class="sig-prename descclassname"><span class="pre">seismolib.</span></span><span class="sig-name descname"><span class="pre">xyz2grd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismolib.xyz2grd" title="Link to this definition"></a></dt>
<dd><p>Convert xyz data to grd data by usin PyGMT.xyz2grd module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – independent variable arrays x[nx], y[ny]</p></li>
<li><p><strong>z</strong> (<em>array-like</em>) – two-dimensional array
z[nx,ny]</p></li>
<li><p><strong>region</strong> (<em>array-like</em><em> or </em><em>str</em>) – GMT’s region setting (automatically detemined by default)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pygmt.grddata</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Takuto Maeda.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>